{{$P:=8}}{{$v:=204255221017214977}}{{$Q:=false}}{{range .Member.Roles}}{{if in (cslice 818943711508693004 757760951620468817 723187777465876543) .}}{{$Q =true}}{{end}}{{end}}{{$J:="‚ùå **You need to be a DJ to do this!**"}}{{$R:=cslice}}{{with (dbGet 20 "queue").Value}}{{$R =$R.AppendSlice .}}{{end}}{{$K:=cslice}}{{$E:=cslice}}{{range $S,$T:=$R}}{{if $S}}{{$K =$K.Append $T}}{{end}}{{if gt $S 1}}{{$E =$E.Append $T}}{{end}}{{end}}{{$T:=execAdmin "prefix"}}{{$U:=reReplace `[\.\[\]\-\?\!\\\*\{\}\(\)\|\+\$\^]` (slice $T (add 15 (len (str .Guild.ID))) (sub (len $T) 1)) `\$0`}}{{$w:=0}}{{$j:=0}}{{$g:=cslice}}{{range .Guild.VoiceStates}}{{if eq .UserID $v}}{{$w =.ChannelID}}{{range $.Guild.VoiceStates}}{{if eq .ChannelID $w}}{{$g =$g.Append .}}{{end}}{{end}}{{else if eq .UserID $.User.ID}}{{$j =.ChannelID}}{{end}}{{end}}{{define "a"}}{{$U:=index . 0}}{{$V:=index . 1}}{{$W:=index . 2}}{{if eq $V 0}}{{$X:="Nothing"}}{{if index . 3}}{{$X =(index . 3 0).title}}{{end}}{{dbDel 20 "skip"}}{{sendMessage nil (cembed "title" "üé∂ Now playing" "description" (printf "%s - %s\n\nLength: `%s`\n\nRequested By: <@%d>\n\nUp next: `%s`" $W.artist $W.title $W.length $W.req $X ) "color" (randInt 16777217))}}{{else}}{{$Y:=""}}{{$x:=toInt (roundCeil (div (toFloat (len $W)) 10))}}{{$B:=toInt (index . 3)}}{{if not (or $W $x)}}‚ùå **Queue is empty!**{{else if and (gt $B 0) (le $B $x)}}{{$Z:=sub (mult $B 10) 10}}{{$0:=$Z}}{{$1:=currentTime}}{{range $S,$T:=$W}}{{if and (ge $S $0) (lt $S (add $0 10))}}{{$Z =add $Z 1}}{{$1 =$1.Add (toDuration $T.length)}}{{$2:=""}}{{with $T.req}}{{$2 =print " <@" . ">"}}{{end}}{{$Y =printf "%s\n\n`%d.` [%s - %s](https://music.youtube.com/search?q=%s+%s) **[%s]**%s" $Y $Z $T.artist $T.title (urlquery (lower $T.title)) (urlquery (lower $T.artist)) $T.length $2}}{{end}}{{end}}{{$y:="üéµ Available songs"}}{{$k:=print "Page " $B "/" $x}}{{if eq $V 1}}{{$y ="üìÉ Queue"}}{{$k =print $k " ‚Ä¢ " (len $W) " songs ‚Ä¢ " (($1.Sub currentTime).Round (index . 4))}}{{end}}{{sendMessage nil (cembed "title" $y "description" $Y "color" 3324667 "thumbnail" (sdict "url" "https://raw.githubusercontent.com/iamcal/emoji-data/master/img-google-136/1f3b5.png") "footer" (sdict "text" $k))}}{{else}}‚ùå **That page doesn't exist!**{{end}}{{end}}{{end}}{{define "b"}}{{$X:=exec "sb" (print .artist " - " .title " [" .length "]")}}{{end}}{{define "e"}}{{$X:=execAdmin "sbclose"}}{{dbDel 20 "skip"}}{{end}}{{define "c"}}{{cancelScheduledUniqueCC . "music"}}{{end}}{{define "s"}}{{scheduleUniqueCC (index . 0) nil (div (toDuration (index . 1)) 1000000000) "music" 1}}{{end}}{{define "p"}}{{$U:=index . 0}}{{$V:=index . 1}}{{$2:=index . 2}}{{$R:=index . 3}}{{$K:=index . 4}}{{$F:=index . 6}}{{if $F}}{{$C:=sdict}}{{$G:=0}}{{range index . 5}}{{$z:=len (reFind (print `(?i)` ((split (reReplace `[[\]\\.?^${}()|*+]` $F `\$0`) "`"|joinStr `\x60`))) .title)}}{{if and $z (or (eq $G 0) (lt $z $G))}}{{$G =$z}}{{$C =sdict .}}{{end}}{{end}}{{if $C}}{{$C.Set "req" $2}}{{if eq $V 0}}{{dbSet 20 "queue" ($R.Append $C)}}üìÉ **Queued `{{print $C.artist " - " $C.title}}`!**{{else if eq $V 1}}{{dbSet 20 "queue" ((cslice (index $R 0) $C).AppendSlice $K)}}üìÉ **Next up `{{print $C.artist " - " $C.title}}`!**{{else}}{{template "c" .CCID}}{{template "e"}}{{sendMessage nil "‚è≠ **Skipped!**"}}{{sleep 1}}{{template "b" $C}}{{template "a" (cslice $U 0 $C $K)}}{{template "s" (cslice .CCID $C.length)}}{{dbSet 20 "queue" ((cslice $C).AppendSlice $K)}}{{end}}{{else}}‚ùå **Couldn't find `{{$F}}`!**{{end}}{{else}}‚ùå **Please specify a song!**{{end}}{{end}}{{if .ExecData}}{{$H:=sdict "title" "‚èπ Music stopped" "color" 16734296}}{{$2:=""}}{{if le (len $g) 1}}{{$2 ="üåê Disconnected"}}{{else if $K}}{{with index $K 0}}{{$I:=execAdmin "sb" (print .artist " - " .title " [" .length "]")}}{{template "a" (cslice $U 0 . $E)}}{{template "s" (cslice $.CCID .length)}}{{end}}{{else}}{{$2 ="üèÅ The queue has ended"}}{{end}}{{dbSet 20 "queue" $K}}{{if $2}}{{$H.Set "description" (print "Reason:\n" $2)}}{{sendMessage nil (cembed $H)}}{{end}}{{else}}{{$m:=cembed "title" "‚ùå Syntax:" "description" (print "Basic usage is: *" $U "music <action> [arguments]*\nMore advanced usage can be found [here](https://github.com/Engineer152/yagpdb-sb-music#the-command-actions-are-as-follows).\n\nYou can also do: " $U "music help <action>") "color" 16734296}}{{if gt (len .Args) 1}}{{$F:=""}}{{range $S,$T:=.CmdArgs}}{{if $S}}{{$F =print $F " " $T}}{{end}}{{end}}{{if $F}}{{$F =slice $F 1}}{{end}}{{$L:=execAdmin "sb"}}{{$A:=cslice}}{{range reFindAllSubmatches `\x60.+?\x60` (slice $L 29 (sub (len $L) 36))}}{{with reFindAllSubmatches `\A\x60(.+?)\s-\s(.+?)\s\[(.+?)\]\x60\z` (index . 0)}}{{$A =$A.Append (sdict "artist" (index . 0 1) "length" (index . 0 3) "title" (index . 0 2))}}{{end}}{{end}}{{$3:=lower (index .Args 1)}}{{if eq $3 "help" "h"}}{{with $P}}{{$X:="all"}}{{if $F}}{{$X =$F}}{{end}}{{execCC . nil 0 $X}}{{else}}‚ùå **Options CCID is not set!**{{end}}{{else if eq $3 "list" "l"}}{{template "a" (cslice $U 2 $A (or $F 1))}}{{else if eq $3 "search" "find"}}{{if $F}}{{$z:=cslice}}{{range $S,$T:=$A}}{{if reFind (print `(?i)` ((split (reReplace `[[\]\\.?^${}()|*+]` $F `\$0`) "`"|joinStr `\x60`))) $T.title}}{{$z =$z.Append (sdict "artist" $T.artist "length" $T.length "title" $T.title "number" $S)}}{{end}}{{end}}{{with $z}}{{$H:=sdict "title" "üéµ Songs found"}}{{$Y:=""}}{{range $S,$T:=.}}{{if lt $S 10}}{{$Y =printf "%s\n\n`%d.` [%s - %s](https://music.youtube.com/search?q=%s+%s) **[%s]**" $Y (add $T.number 1) $T.artist $T.title (urlquery (lower $T.title)) (urlquery (lower $T.artist)) $T.length}}{{end}}{{end}}{{if ge (len $z) 10}}{{$Y =print $Y "\n\n\n**Only showing the first 10 results**"}}{{end}}{{$H.Set "description" $Y}}{{sendMessage nil (cembed $H)}}{{else}}‚ùå **No songs found with `{{$F}}`!**{{end}}{{else}}‚ùå **Please specify a search query!**{{end}}{{else if eq $3 "grab" "save" "yoink"}}{{with index $R 0}}{{sendDM (cembed "title" "üé∂ Current song" "description" (print .artist " - " .title "\n\nLength: `" .length "`"))}}{{end}}üì¨ <{{.User.ID}}>**, you've got mail!**{{else if eq $3 "play" "p"}}{{template "p" (cslice $U 0 .User.ID $R $K $A $F)}}{{else if eq $3 "playall" "pa"}}{{if $Q}}{{range $A}}{{.Set "req" $.User.ID}}{{end}}{{dbSet 20 "queue" ($R.AppendSlice $A)}}üìÉ **Queued all songs I could find!**{{else}}{{$J}}{{end}}{{else if eq $3 "random" "r"}}{{with index $A (randInt (sub (len $A) 1))}}{{.Set "req" $.User.ID}}‚ú® **Random song is...** `{{print .artist " - " .title}}`{{dbSet 20 "queue" ($R.Append .)}}{{end}}{{else if eq $3 "queue" "q"}}{{$X:=$R}}{{if $w}}{{$R =$K}}{{end}}{{template "a" (cslice $U 1 $X (or $F 1) .TimeSecond)}}{{else if eq $3 "clear" "cl"}}{{if $Q}}{{$M:="‚ùå **Nothing cleared!**"}}{{$4:=cslice (index $R 0)}}{{if $F}}{{$5:=0}}{{with .Message.Mentions}}{{$5 =(index . 0).ID}}{{end}}{{with or $5 (toInt $F)}}{{$5 =.}}{{$X:=$R}}{{if $w}}{{$X =$K}}{{end}}{{$E:=cslice}}{{range $X}}{{if ne .req $5}}{{$E =$E.Append .}}{{end}}{{end}}{{if lt (len $E) (len $X)}}{{if not $w}}{{$4 =cslice}}{{end}}{{dbSet 20 "queue" ($4.AppendSlice $E)}}üóë **Queue cleared for <@{{$5}}>!**{{else}}{{$M}}{{end}}{{end}}{{else}}{{$N:="üóë **Queue cleared!**"}}{{if $w}}{{if $K}}{{dbSet 20 "queue" $4}}{{$N}}{{else}}{{$M}}{{end}}{{else}}{{dbDel 20 "queue"}}{{$N}}{{end}}{{end}}{{else}}{{$J}}{{end}}{{else}}{{if not (reFind `^(n(?:owplaying|p)|(?:f(?:orce)?ski|p(?:layski|(?:lay)?to|ski))p|p(?:laynow|n)|s(?:huffle|t(?:art|op))|r(?:andom|eplay|emove)|begin|end|pt|ps|fs|e|rm?|b)$` $3)}}{{sendMessage nil $m}}{{else if not $j}}‚ùå **You're not in a voice channel!**{{else if eq $3 "start" "begin" "b"}}{{if $w}}‚ùå <@{{$v}}> **is already playing something!**{{else if $R}}{{template "c" .CCID}}{{with index $R 0}}{{template "b" .}}{{sendMessage nil "üé∂ **Music started!**"}}{{template "a" (cslice $U 0 . $K)}}{{template "s" (cslice $.CCID .length)}}{{end}}{{else}}ü§∑‚Äç‚ôÇÔ∏è **No songs in the queue**{{end}}{{else if not $w}}‚ùå **Nothing is playing right now!**{{else if ne $w $j}}‚ùå **You need to be in the same voice channel as <@{{$v}}>!**{{else if eq $3 "forceskip" "fs" "fskip"}}{{if $Q}}{{$X:=1}}{{if $F}}{{$X =toInt $F}}{{end}}{{if eq $X 0}}‚ùå **Please enter a valid number!**{{else}}{{sendMessage nil "‚è≠ **Skipped!**"}}{{template "c" .CCID}}{{template "e"}}{{$E:=cslice}}{{range $S,$T:=$R}}{{if ge $S $X}}{{$E =$E.Append $T}}{{end}}{{end}}{{if $E}}{{$D:=cslice}}{{range $S,$T:=$E}}{{if $S}}{{$D =$D.Append $T}}{{end}}{{end}}{{with index $E 0}}{{sleep 1}}{{template "b" .}}{{template "a" (cslice $U 0 . $D)}}{{template "s" (cslice $.CCID .length)}}{{end}}{{dbSet 20 "queue" $E}}{{else}}{{execCC .CCID nil 0 1}}{{end}}{{end}}{{else}}{{$J}}{{end}}{{else if eq $3 "replay"}}{{template "c" .CCID}}{{template "e"}}{{with index $R 0}}{{.Set "req" $.User.ID}}{{dbSet 20 "queue" $R}}{{sleep 1}}{{template "b" .}}‚Ü™ **Replaying `{{print .artist " - " .title}}`!**{{template "s" (cslice $.CCID .length)}}{{end}}{{else if eq $3 "playtop" "pt" "ptop"}}{{template "p" (cslice $U 1 .User.ID $R $K $A $F)}}{{else if eq $3 "playskip" "ps" "pskip" "playnow" "pn"}}{{template "p" (cslice $U 2 .User.ID $R $K $A $F)}}{{else if eq $3 "stop" "end" "e"}}{{template "c" .CCID}}{{template "e"}}‚èπ **Music stopped!**{{dbSet 20 "queue" $K}}{{else if eq $3 "nowplaying" "np"}}{{template "a" (cslice $U 0 (index $R 0) $K)}}{{else if eq $3 "remove" "rm"}}{{if $Q}}{{if $F}}{{$X:=$R}}{{$4:=cslice (index $R 0)}}{{if $w}}{{$X =$K}}{{end}}{{$E:=cslice}}{{$O:=cslice}}{{$V:=0}}{{range split $F " "}}{{with toInt .}}{{$O =$O.Append .}}{{end}}{{end}}{{range $S,$T:=$X}}{{if in $O (add $S 1)}}{{$V =add $V 1}}{{else}}{{$E =$E.Append $T}}{{end}}{{end}}üóë **Removed {{$V}} songs!**{{if $w}}{{dbSet 20 "queue" ($4.AppendSlice $E)}}{{else}}{{dbSet 20 "queue" $E}}{{end}}{{else}}‚ùå **Please input a number!**{{end}}{{else}}{{$J}}{{end}}{{else if eq $3 "shuffle"}}{{if $Q}}{{if $K}}{{dbSet 20 "queue" (shuffle $K)}}üîÄ **Shuffled the queue!**{{else}}‚ùå **Nothing to shuffle!**{{end}}{{else}}{{$J}}{{end}}{{end}}{{end}}{{else}}{{sendMessage nil $m}}{{end}}{{end}}